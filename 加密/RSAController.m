//
//  RSAController.m
//  加密
//
//  Created by Jason on 15/9/8.
//  Copyright (c) 2015年 www.jizhan.com. All rights reserved.
//

#import "RSAController.h"
#import "RSA.h"
#import "Base64.h"

#define kPublicKeyBase64Code @"MIIDjjCCAnYCCQDprFiMx5mMmDANBgkqhkiG9w0BAQUFADCBiDELMAkGA1UEBhMCQ04xEjAQBgNVBAgTCUd1YW5nRG9uZzERMA8GA1UEBxMIU2hlblpoZW4xDzANBgNVBAoTBkppWmhhbjEPMA0GA1UECxMGSmlaaGFuMQ8wDQYDVQQDEwZKaVpoYW4xHzAdBgkqhkiG9w0BCQEWEDk5NDk3ODM1NEBxcS5jb20wHhcNMTUwOTA4MDYxNTQ4WhcNMjUwOTA1MDYxNTQ4WjCBiDELMAkGA1UEBhMCQ04xEjAQBgNVBAgTCUd1YW5nRG9uZzERMA8GA1UEBxMIU2hlblpoZW4xDzANBgNVBAoTBkppWmhhbjEPMA0GA1UECxMGSmlaaGFuMQ8wDQYDVQQDEwZKaVpoYW4xHzAdBgkqhkiG9w0BCQEWEDk5NDk3ODM1NEBxcS5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQQQLh7SPO1DwibP5IqFIfVIdqngOKaxSxz8Z8NjWVQtInprSTbvS+pz7D5XNLDy9ytxco6W+TpRQ/Ew6TX8SNC3l5+oQ9pdO6abbGIcdrYMGj4bpi8hCZzzvMbiAdT5bbi/54JpGX2Kg//ZBsq9/ptBAbYjhULJcXcqFnxNM/xvbjDJYkOu+kCKmNwl/Ae2ViF3sraSMCYMnTTzK6ZcfPUfm2GSmk9mPsDNzHZSxjgRGZ17m32s69HlLZCXFAVGQZyN6OTuhyRxbk6wWaFgg7rxhl6/rHV/EP3PZO2C4TboBxqjAkcy9/mEeQ297VzxIPLS5fJs7z9f21YjPbj22PAgMBAAEwDQYJKoZIhvcNAQEFBQADggEBAG3hsa3vQzEylxun1vr79meMtIN6YWVWDFIxF63jsMQff9jOZfQceYFVop/OJw89LE3OlNrdmLRnMVglxzlseOIxtNESgy8ldRlTeUY06D0j94/IZBe0NzkHzLNgs2dej62XNbsCEUNM2oXW50Ze8ZkSt+OnPy30OZw2FrIAPhCz+KJcPQKEr+kxOHWzLCUBP0iSdFw8cZqXZ9S23NlMe1P6Q0JtqFRKeccK8Ek3hkDbcYKHWBp3YlG1lPSNOpHzZS5OAuSzcOzzWK8OYo7etfmYC0zfG4b2HNsOdbFxulEutox1hx2OqOjUNwPFk5XYglWdtqGuu+aYPqYHxETxtic="
#define kPrivateKeyBase64Code @"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"

@interface RSAController ()

@property (strong, nonatomic) RSA *rsa;

@property (weak, nonatomic) IBOutlet UITextField *contentTF;
@property (weak, nonatomic) IBOutlet UILabel *encryptLabel;
@property (weak, nonatomic) IBOutlet UILabel *decryptLabel;

@end

@implementation RSAController

- (IBAction)encrypt:(id)sender {
    
    self.encryptLabel.text = [self.rsa rsaEncryptString:self.contentTF.text];
    
}
- (IBAction)decrypt:(id)sender {
    
    self.decryptLabel.text = [self.rsa rsaDecryptString:self.encryptLabel.text];
    
}

- (void)viewDidLoad {
    [super viewDidLoad];
    
    self.title = @"RSA加密";
    
    self.rsa = [[RSA alloc] init];
    
    //获得公钥base64编码
    NSData *data = [NSData dataWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"public_key" ofType:@"der"]];
    self.rsa.public_key = [data base64EncodedStringWithWrapWidth:0];
    
    //获得私钥p12的base64编码
    NSData *p12Data = [NSData dataWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"private_key" ofType:@"p12"]];
    
    [self.rsa loadPrivate_key:[p12Data base64EncodedStringWithWrapWidth:0] password:@"123456"];
}


@end
